import numpy as np
import matplotlib.pyplot as plt

X = np.array([[0, 1], [8, 1], [0, 1], [8, 1]])
y = np.array([10, 7, 7, 6])


# –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –ø—Ä—è–º–æ–π –ø–æ —Ñ–æ—Ä–º—É–ª–µ.
# w ‚Äî –≤–µ–∫—Ç–æ—Ä –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ [k, m].
w = np.linalg.inv(X.T @ X) @ X.T @ y

# –¢–∞–∫–∂–µ –º–æ–∂–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã —Å—Ä–∞–∑—É –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ.
k, m = np.linalg.inv(X.T @ X) @ X.T @ y

# –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω–æ–π —Ç–æ—á–∫–∏ –º–æ–∂–Ω–æ –ø–æ —Ñ–æ—Ä–º—É–ª–µ –ø—Ä—è–º–æ–π.
x_test = 6
y_pred = w[0] * x_test + w[1]
print(f"–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —á–µ—Ä–µ–∑ {x_test} —á–∞—Å–∞(–æ–≤) –ø–æ—Å–ª–µ –Ω–∞—á–∞–ª–∞ —Å–º–µ–Ω—ã:")
print(y_pred)


# –ö–æ–¥ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –≥—Ä–∞—Ñ–∏–∫–∞, –µ–≥–æ –º–æ–∂–Ω–æ –Ω–µ –∏–∑–º–µ–Ω—è—Ç—å.
plt.scatter(X[:2, 0], y[:2], s=100, label=f"–î–µ–Ω—å 1")
plt.scatter(X[2:, 0], y[2:], s=100, label=f"–î–µ–Ω—å 2")
plt.scatter(x_test, y_pred, zorder=10, s=100, label="–¢–µ—Å—Ç–æ–≤–∞—è —Ç–æ—á–∫–∞ (x_test, y_pred)")

x_min = -1; x_max = 9
y_min = x_min * w[0] + w[1]
y_max = x_max * w[0] + w[1]

plt.plot(
    [x_min, x_max],
    [y_min, y_max],
    linewidth=3,
    c="C4",
    label="–ù–∞–∏–ª—É—á—à–∞—è –ø—Ä—è–º–∞—è",
)
plt.grid()
plt.ylim(-1, 11.5)
plt.xlim(-1, 9)
plt.ylabel("üòä", rotation=0, fontsize=25, labelpad=20)
plt.xlabel("–ß–∞—Å—ã –ø–æ—Å–ª–µ –Ω–∞—á–∞–ª–∞ —Å–º–µ–Ω—ã, t", fontsize=15)
plt.legend(loc=3)
